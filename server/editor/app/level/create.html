<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!--<script src="https://cdn.tailwindcss.com"></script>-->
    <!--<script src="https://unpkg.com/htmx.org@1.9.4"></script>-->
    <link rel="stylesheet" type="text/css" href="/public/litegraph.css" />
    <script type="text/javascript" src="/public/litegraph.min.js"></script>
    <title>Editor - Unit</title>
  </head>
  <body class="h-screen bg-gray-800 text-white flex flex-col">
    <canvas
      id="level"
      width="1024"
      height="720"
      style="border: 1px solid"
    ></canvas>
    <script>
      const planetName = ["Earth"];

      class PlanetNode {
        static title = "Planet";
        constructor() {
          const id = crypto.randomUUID();

          this.properties = {
            uuid: id,
            name: "",
            connectsTo: [],
            position: { x: 0, y: 0 },
          };

          this.addWidget(
            "number",
            "Position X",
            0,
            (value) => {
              this.properties.position.x = value;
            },
            { step: 1, precision: 0 }
          );

          this.addWidget(
            "number",
            "Position Y",
            0,
            (value) => {
              this.properties.position.y = value;
            },
            { step: 1, precision: 0 }
          );

          this.name_combo = this.addWidget(
            "combo",
            "Name",
            "Earth",
            (value) => {
              this.properties.name = value;
            },
            { values: planetName }
          );

          this.addInput("A", "string");
          this.addInput("B", "string");
          this.addInput("C", "string");
          this.addOutput("D", "string");
          this.addOutput("E", "string");
          this.addOutput("F", "string");
        }

        onExecute() {
          this.properties.connectsTo.push(
            this.getInputData(0),
            this.getInputData(1),
            this.getInputData(2)
          );

          this.setOutputData(0, this.properties.uuid);
          this.setOutputData(1, this.properties.uuid);
          this.setOutputData(2, this.properties.uuid);
        }
      }

      window.addEventListener("DOMContentLoaded", () => {
        const graph = new LGraph();
        const canvas = new LGraphCanvas("#level", graph);

        console.log(LiteGraph);

        LiteGraph.registerNodeType("basic/planet", PlanetNode);

        graph.start();
      });
    </script>
  </body>
</html>
